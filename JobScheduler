// Sort rows by the "Usage" column (keeping "SNO" static)
rows.subList(1, rows.size()).sort((row1, row2) -> {
    int usage1 = Integer.parseInt(row1.getCell(4).getStringCellValue()); // Usage column
    int usage2 = Integer.parseInt(row2.getCell(4).getStringCellValue());
    return Integer.compare(usage2, usage1); // Descending order
});

// Create a new workbook to write sorted data
Workbook sortedWorkbook = new XSSFWorkbook();
Sheet sortedSheet = sortedWorkbook.createSheet("Sorted Data");

// Write sorted rows to the new sheet
for (int i = 0; i < rows.size(); i++) {
    Row newRow = sortedSheet.createRow(i);
    Row originalRow = rows.get(i);

    for (int j = 0; j < originalRow.getLastCellNum(); j++) {
        Cell originalCell = originalRow.getCell(j);
        Cell newCell = newRow.createCell(j);

        if (originalCell != null) {
            switch (originalCell.getCellType()) {
                case STRING:
                    newCell.setCellValue(originalCell.getStringCellValue());
                    break;
                case NUMERIC:
                    newCell.setCellValue(originalCell.getNumericCellValue());
                    break;
                case BOOLEAN:
                    newCell.setCellValue(originalCell.getBooleanCellValue());
                    break;
                case FORMULA:
                    newCell.setCellFormula(originalCell.getCellFormula());
                    break;
                default:
                    break;
            }
            // Copy cell styles
            newCell.setCellStyle(originalCell.getCellStyle());
        }
    }
}

// Reassign "SNO" column values to preserve their original sequence
for (int i = 1; i < sortedSheet.getLastRowNum() + 1; i++) {
    Row row = sortedSheet.getRow(i);
    if (row != null) {
        Cell snoCell = row.getCell(0); // SNO column index
        if (snoCell != null) {
            snoCell.setCellValue(i); // Update SNO based on the row index
        }
    }
}

// Save the sorted workbook to a file
try (FileOutputStream outputStream = new FileOutputStream("SortedData.xlsx")) {
    sortedWorkbook.write(outputStream);
}
