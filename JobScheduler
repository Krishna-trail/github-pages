// Utility to copy a CellStyle
private static CellStyle copyCellStyle(CellStyle originalStyle, Workbook targetWorkbook) {
    CellStyle newStyle = targetWorkbook.createCellStyle();
    newStyle.cloneStyleFrom(originalStyle);
    return newStyle;
}

// Modified part of the code
for (int i = 0; i < rows.size(); i++) {
    Row newRow = sortedSheet.createRow(i);
    Row originalRow = rows.get(i);

    // Copy "SNO" column
    Cell originalSnoCell = originalRow.getCell(0); // SNO column
    Cell newSnoCell = newRow.createCell(0); // SNO column in new workbook

    if (originalSnoCell != null) {
        newSnoCell.setCellValue(originalSnoCell.getNumericCellValue()); // Copy value
        CellStyle snoStyle = copyCellStyle(originalSnoCell.getCellStyle(), sortedWorkbook);
        newSnoCell.setCellStyle(snoStyle); // Copy style
    }

    // Copy other columns
    for (int j = 1; j < originalRow.getLastCellNum(); j++) { // Start from index 1
        Cell originalCell = originalRow.getCell(j);
        Cell newCell = newRow.createCell(j);

        if (originalCell != null) {
            switch (originalCell.getCellType()) {
                case STRING:
                    newCell.setCellValue(originalCell.getStringCellValue());
                    break;
                case NUMERIC:
                    newCell.setCellValue(originalCell.getNumericCellValue());
                    break;
                case BOOLEAN:
                    newCell.setCellValue(originalCell.getBooleanCellValue());
                    break;
                case FORMULA:
                    newCell.setCellFormula(originalCell.getCellFormula());
                    break;
                default:
                    break;
            }
            // Copy style
            CellStyle newStyle = copyCellStyle(originalCell.getCellStyle(), sortedWorkbook);
            newCell.setCellStyle(newStyle);
        }
    }
}
